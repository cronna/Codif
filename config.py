import os
import json
from dotenv import load_dotenv

load_dotenv()

class Config:
    BOT_TOKEN = os.getenv("BOT_TOKEN", "8076800755:AAETbYbCio_e1cM_lErJmovtVyTPzpxbNJw")
    CHANNEL_LINK = os.getenv("CHANNEL_LINK", "https://t.me/codifofficial")
    ADMIN_IDS = [
        int(admin_id.strip()) 
        for admin_id in os.getenv("ADMIN_IDS", "5534526646").split(",")
        if admin_id.strip().isdigit()
    ]
    DATABASE_URL = os.getenv("DATABASE_URL", "sqlite:///bot.db")
    LOG_LEVEL = os.getenv("LOG_LEVEL", "INFO")
    LOG_FORMAT = "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
    MAX_MESSAGE_LENGTH = 4096
    MAX_BUTTONS_PER_ROW = 2
    EMOJI = {
        "bot": "🤖",
        "team": "👥", 
        "portfolio": "🎨",
        "consultation": "💬",
        "admin": "👑",
        "back": "◀️",
        "next": "▶️",
        "success": "✅",
        "error": "❌",
        "warning": "⚠️",
        "info": "ℹ️",
        "edit": "✏️",
        "delete": "🗑️",
        "add": "➕",
        "contact": "📞",
        "channel": "📢",
        "star": "⭐",
        "fire": "🔥",
        "rocket": "🚀",
        "gem": "💎",
        "crown": "👑",
        "lightning": "⚡",
        "sparkles": "✨",
        "target": "🎯",
        "magic": "🪄",
        "crystal": "🔮",
        "trophy": "🏆",
        "medal": "🥇",
        "shield": "🛡️",
        "key": "🔑",
        "lock": "🔒",
        "home": "🏠",
        "arrow_up": "⬆️",
        "arrow_down": "⬇️",
        "check": "✔️",
        "gift": "🎁",
        "money": "💰",
        "chart": "📊",
        "wallet": "💳",
        "history": "📋",
        "link": "🔗",
        "card": "💳",
        "phone": "📱",
        "person": "👤",
        "request": "💸",
        "refresh": "🔄",
        "pending": "⏳",
        "confirmed": "✅",
        "paid": "💸",
        "balance": "💰",
        "referral": "👥",
        "earnings": "💵",
        "payout": "💸",
        "cross": "✖️",
        "heart": "❤️",
        "thumbs_up": "👍",
        "handshake": "🤝",
        "money": "💰",
        "time": "⏰",
        "calendar": "📅",
        "document": "📄",
        "bulb": "💡",
        "chart": "📊",
        "tools": "🛠️",
        "computer": "💻",
        "phone": "📱",
        "robot": "🤖",
        "miniapp": "📱",
        "email": "📧",
        "message": "💌",
        "bell": "🔔",
        "megaphone": "📣",
        "loudspeaker": "📢",
        "microphone": "🎤",
        "camera": "📷",
        "video": "🎥",
        "play": "▶️",
        "pause": "⏸️",
        "stop": "⏹️",
        "record": "⏺️",
        "fast_forward": "⏩",
        "rewind": "⏪",
        "repeat": "🔁",
        "shuffle": "🔀",
        "volume_up": "🔊",
        "volume_down": "🔉",
        "mute": "🔇",
        "battery": "🔋",
        "plug": "🔌",
        "signal": "📶",
        "wifi": "📶",
        "bluetooth": "📶",
        "location": "📍",
        "map": "🗺️",
        "compass": "🧭",
        "globe": "🌍",
        "satellite": "🛰️",
        "airplane": "✈️",
        "car": "🚗",
        "train": "🚆",
        "ship": "🚢",
        "bicycle": "🚴",
        "walking": "🚶",
        "running": "🏃",
        "dancing": "💃",
        "music": "🎵",
        "note": "🎶",
        "headphones": "🎧",
        "radio": "📻",
        "tv": "📺",
        "movie": "🎬",
        "game": "🎮",
        "dice": "🎲",
        "puzzle": "🧩",
        "art": "🎨",
        "brush": "🖌️",
        "palette": "🎨",
        "frame": "🖼️",
        "book": "📚",
        "newspaper": "📰",
        "magazine": "📖",
        "scroll": "📜",
        "page": "📃",
        "clipboard": "📋",
        "pushpin": "📌",
        "paperclip": "📎",
        "ruler": "📏",
        "triangular_ruler": "📐",
        "scissors": "✂️",
        "pen": "🖊️",
        "pencil": "✏️",
        "crayon": "🖍️",
        "paintbrush": "🖌️",
        "magnifying_glass": "🔍",
        "microscope": "🔬",
        "telescope": "🔭",
        "crystal_ball": "🔮",
        "joystick": "🕹️",
        "slot_machine": "🎰",
        "bowling": "🎳",
        "pool": "🎱",
        "yo_yo": "🪀",
        "kite": "🪁",
        "magic_wand": "🪄"
    }
    MESSAGES = {
        "welcome": (
        f"{EMOJI['sparkles']} <b>Добро пожаловать в Codif Bot!</b> {EMOJI['sparkles']}\n\n"
        f"{EMOJI['rocket']} <i>Мы создаем инновационные телеграм боты и современные веб-приложения</i>\n\n"
        f"{EMOJI['gem']} <b>Выберите интересующий раздел:</b>"
    ),
        "order_success": f"{EMOJI['success']} <b>Заявка успешно отправлена!</b>\n\nМы получили вашу заявку и свяжемся с вами в ближайшее время для обсуждения деталей проекта.\n\n{EMOJI['info']} <i>Обычно мы отвечаем в течение 2-4 часов в рабочее время.</i>",
        "referral_welcome": f"{EMOJI['gift']} <b>Реферальная программа Codif</b>\n\n{EMOJI['money']} <b>Зарабатывайте 25% с каждого заказа!</b>\n\nПриводите клиентов и получайте 25% от стоимости их заказов. Выплаты производятся на карту или через СБП после подтверждения оплаты заказа.\n\n{EMOJI['info']} <i>Все начисления и выплаты полностью прозрачны</i>",
        "referral_stats": f"{EMOJI['chart']} <b>Ваша статистика</b>",
        "referral_no_stats": f"{EMOJI['info']} <b>Добро пожаловать в реферальную программу!</b>\n\nВы еще не зарегистрированы как реферер. Нажмите кнопку ниже, чтобы получить свою реферальную ссылку.",
        "referral_link_generated": f"{EMOJI['link']} <b>Ваша реферальная ссылка готова!</b>\n\nОтправляйте эту ссылку друзьям и знакомым. За каждый оплаченный заказ вы получите 25% комиссии.\n\n{EMOJI['info']} <i>Ссылка работает бессрочно</i>",
        "setup_wallet_prompt": f"{EMOJI['wallet']} <b>Настройка выплат</b>\n\nВыберите удобный способ получения выплат:",
        "enter_card_number": f"{EMOJI['card']} <b>Введите номер карты</b>\n\nУкажите номер карты для получения выплат:\n\n{EMOJI['info']} <i>Формат: 1234 5678 9012 3456</i>",
        "enter_phone_number": f"{EMOJI['phone']} <b>Введите номер телефона</b>\n\nУкажите номер телефона для СБП:\n\n{EMOJI['info']} <i>Формат: +7 900 123 45 67</i>",
        "enter_full_name": f"{EMOJI['person']} <b>Введите ФИО</b>\n\nУкажите ваше полное имя для переводов:\n\n{EMOJI['info']} <i>Например: Иванов Иван Иванович</i>",
        "wallet_setup_success": f"{EMOJI['success']} <b>Данные для выплат сохранены!</b>\n\nТеперь вы можете запрашивать выплаты заработанных средств.",
        "no_earnings": f"{EMOJI['info']} <b>У вас пока нет начислений</b>\n\nПриводите клиентов по вашей реферальной ссылке, и здесь появятся ваши заработки!",
        "payout_request_success": f"{EMOJI['success']} <b>Запрос на выплату отправлен!</b>\n\nВаш запрос передан администратору. Выплата будет произведена в течение 24 часов.\n\n{EMOJI['info']} <i>Вы получите уведомление о завершении выплаты</i>",
        "insufficient_balance": f"{EMOJI['warning']} <b>Недостаточно средств</b>\n\nНа вашем балансе недостаточно средств для выплаты. Минимальная сумма для вывода: 500₽",
        "payout_completed": f"{EMOJI['success']} <b>Выплата завершена!</b>\n\nСредства переведены на ваши реквизиты. Спасибо за участие в реферальной программе!",
        "admin_order_accepted": f"{EMOJI['success']} <b>Заказ принят!</b>\n\nЦена установлена и клиент уведомлен о принятии заказа.",
        "admin_payment_confirmed": f"{EMOJI['success']} <b>Оплата подтверждена!</b>\n\nКлиент и реферер (если есть) уведомлены о подтверждении оплаты.",
        "admin_no_accepted_orders": f"{EMOJI['info']} <b>Нет заказов для подтверждения оплаты</b>\n\nВсе принятые заказы уже оплачены или ожидают оплаты.",
        "admin_no_pending_payouts": f"{EMOJI['info']} <b>Нет запросов на выплату</b>\n\nВсе выплаты обработаны или запросов пока нет.",
        "admin_payout_approved": f"{EMOJI['success']} <b>Выплата одобрена!</b>\n\nРеферер уведомлен об одобрении выплаты.",
        "admin_payout_rejected": f"{EMOJI['error']} <b>Выплата отклонена!</b>\n\nРеферер уведомлен об отклонении с указанием причины.",
        "admin_payout_completed": f"{EMOJI['success']} <b>Выплата завершена!</b>\n\nРеферер уведомлен о завершении выплаты.",
        "client_order_accepted": f"{EMOJI['success']} <b>Ваш заказ принят!</b>\n\nДля оплаты свяжитесь с администратором. После подтверждения оплаты мы приступим к работе!",
        "client_payment_confirmed": f"{EMOJI['success']} <b>Оплата подтверждена!</b>\n\nМы приступаем к работе над вашим проектом!",
        "referrer_commission_earned": f"{EMOJI['money']} <b>Новое начисление!</b>\n\nВаш реферал оплатил заказ и вам начислена комиссия.",
        "referrer_payout_approved": f"{EMOJI['success']} <b>Выплата одобрена!</b>\n\nВыплата будет произведена в течение 1-3 рабочих дней.",
        "referrer_payout_rejected": f"{EMOJI['error']} <b>Выплата отклонена</b>\n\nОбратитесь к администратору для уточнения деталей.",
        "referrer_payout_completed": f"{EMOJI['success']} <b>Выплата завершена!</b>\n\nСредства переведены на ваши реквизиты.",
        "application_success": "🌟 <b>Заявка в команду принята!</b>\n\n🔍 Мы тщательно рассмотрим вашу кандидатуру\n\n📞 <i>Ожидайте обратную связь в ближайшие дни</i>",
        "consultation_success": "💬 <b>Запрос на консультацию получен!</b>\n\n🎯 Наш эксперт подготовит детальный ответ\n\n⚡ <i>Обычно отвечаем в течение нескольких часов</i>",
        "no_portfolio": "🎨 <b>Портфолио временно недоступно</b>\n\n🔄 <i>Мы обновляем наши проекты</i>\n\n📅 Загляните чуть позже!",
        "access_denied": "🔒 <b>Доступ ограничен</b>\n\n👤 <i>У вас нет прав для этой функции</i>",
        "error_occurred": "⚠️ <b>Что-то пошло не так</b>\n\n🔄 <i>Попробуйте повторить операцию</i>\n\n📞 Если проблема повторяется - свяжитесь с поддержкой",
        "cancelled": "❌ <b>Операция отменена</b>\n\n🔙 <i>Возвращаемся к предыдущему шагу</i>",
        "back_to_main": "🏠 <b>Возвращаемся в главное меню</b>\n\n✨ <i>Готовы к новым задачам!</i>"
    }
    try:
        EMOJI_CUSTOM = json.loads(os.getenv("CUSTOM_EMOJI_MAP", "{}"))
        if not isinstance(EMOJI_CUSTOM, dict):
            EMOJI_CUSTOM = {}
    except Exception:
        EMOJI_CUSTOM = {}
config = Config()
BOT_TOKEN = config.BOT_TOKEN
CHANNEL_LINK = config.CHANNEL_LINK
ADMIN_IDS = config.ADMIN_IDS